generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Розробники
// ID розробника, назва, код ЄДРПОУ
model Developer {
  id          Int          @id @default(autoincrement())
  name        String
  edrpou      String?
  professions Profession[]
}

// Професії
// ID розробника, назва, код ЄДРПОУ
model Profession {
  id           Int        @id @default(autoincrement())
  name         String
  code         String
  developerId  Int        @default(1)
  approvalDate DateTime   @default(now())
  developer    Developer  @relation(fields: [developerId], references: [id], onDelete: Restrict)
  professionalQualifications ProfessionalQualification[]
}

// Профкваліфікації
// ID розробника, назва, код ЄДРПОУ
model ProfessionalQualification {
  id            Int           @id @default(autoincrement())
  name          String
  nkrLevel      Int
  professionId  Int
  profession    Profession    @relation(fields: [professionId], references: [id])
  accreditations Accreditation[]
  persons        Person[]
  experts        Expert[]
  examinations   Examination[]
}

// Кваліфікаційні центри
// ID квалцентру, назва центру, код ЄДРПОУ, адреса
model QualificationCenter {
  id              Int            @id @default(autoincrement())
  name            String
  edrpou          String
  address         String
  accreditations  Accreditation[]
  persons         Person[]
  examinations    Examination[]
}

// Акредитації
// ID акредитації, ID профквал, ID квалцентру, номер свідоцтва, дата засідання НАК (нац.агент.квал.)
model Accreditation {
  id                           Int @id @default(autoincrement())
  professionalQualificationId  Int
  qualificationCenterId        Int
  certificateNumber            String
  sessiobNQADate               DateTime @default(now())
  professionalQualification    ProfessionalQualification @relation(fields: [professionalQualificationId], references: [id])
  qualificationCenter          QualificationCenter @relation(fields: [qualificationCenterId], references: [id])
}

// Особи (отримали профквал)
// ID особи, ПІБ особи, ID квалцентру, ID профквал, номер свідоцтва, дата отримання
model Person {
  id                          Int @id @default(autoincrement())
  fullName                    String
  qualificationCenterId       Int
  professionalQualificationId Int
  certificateNumber           String
  dateReceived                DateTime @default(now())
  qualificationCenter         QualificationCenter @relation(fields: [qualificationCenterId], references: [id])
  professionalQualification   ProfessionalQualification @relation(fields: [professionalQualificationId], references: [id])
}

// Експерти
// ID експерта, ПІБ, ID профкваліфікації
model Expert {
  id                         Int                      @id @default(autoincrement())
  fullName                   String
  professionalQualificationId Int
  professionalQualification  ProfessionalQualification @relation(fields: [professionalQualificationId], references: [id])
  examinations               Examination[]
}

// Експертизи
// ID експертизи, ID профквал, ID квалцентру, ID експерта, дата
model Examination {
  id                          Int @id @default(autoincrement())
  professionalQualificationId Int
  qualificationCenterId       Int
  expertId                    Int
  examinationDate             DateTime @default(now())
  professionalQualification   ProfessionalQualification @relation(fields: [professionalQualificationId], references: [id])
  qualificationCenter         QualificationCenter @relation(fields: [qualificationCenterId], references: [id])
  expert                      Expert @relation(fields: [expertId], references: [id])
}


